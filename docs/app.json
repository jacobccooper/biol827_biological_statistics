[{"name":"app.R","content":"#\n# This is a Shiny web application. You can run the application by clicking\n# the 'Run App' button above.\n#\n# Find out more about building applications with Shiny here:\n#\n#    https://shiny.posit.co/\n#\n\nlibrary(shiny)\n\n# Define UI for application that draws a histogram\nui <- fluidPage(\n\n    # Application title\n    titlePanel(\"Effects of sample size\"),\n\n    # Sidebar with a slider input for number of bins \n    sidebarLayout(\n        sidebarPanel(\n          numericInput( \n            \"bins\", \n            \"Numeric input\", \n            value = 15, \n            min = 1, \n            max = 200)\n        ),\n\n        # Show a plot of the generated distribution\n        mainPanel(\n           plotOutput(\"distPlot\"),\n           verbatimTextOutput(\"fullsummary\")\n        )\n        \n        \n        #absolutePanel(renderText(output$sum))\n    )\n)\n\n# Define server logic required to draw a histogram\nserver <- function(input, output) {\n  set.seed(8675309)\n  full.x <- rnorm(n = 200, mean = 0, sd = 1)\n  \n  mu.x <- mean(full.x) |> round(3)\n  sd.x <- sd(full.x) |> round(3)\n  shap.x <- shapiro.test(full.x)\n  \n  output$fullsummary <- renderPrint({\n    set.seed(8675309)\n    x.norm <- sample(full.x, size = input$bins)\n    mu.samp <- mean(x.norm) |> round(3)\n    sd.samp <- sd(x.norm) |> round(3)\n    shap.samp <- shapiro.test(x.norm)\n    \n    print(paste0(\"Original population: mean = 0, sd = 1\"))\n    print(paste0(\"Full sample: mean = \", mu.x,\n                 \", sd = \", sd.x, \n                 \", p = \", round(shap.x$p.value, 3)))\n    print(paste0(\"Your subsample: mean = \", mu.samp,\n                 \", sd = \", sd.samp, \n                 \", p = \", round(shap.samp$p.value, 3)))\n  })\n    \n    output$distPlot <- renderPlot({\n      set.seed(8675309)\n        x.norm <- sample(full.x, size = input$bins)\n        mu.samp <- mean(x.norm) |> round(3)\n        sd.samp <- sd(x.norm) |> round(3)\n        shap.samp <- shapiro.test(x.norm)\n      \n        # generate bins based on input$bins from ui.R\n        # bins <- seq(min(x.norm), max(x.norm), length.out = input$bins + 1)\n        if(input$bins < 50){bins = 8}\n        if(input$bins >= 50){bins = 20}\n\n        # draw the histogram with the specified number of bins\n        hist(x.norm, breaks = bins, col = 'darkgray', border = 'white',\n             xlab = 'Random value',\n             main = 'Histogram from a random normal distribution')\n    }\n    \n    )\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"}]
